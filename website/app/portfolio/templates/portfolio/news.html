{% extends 'base.html' %}
{% load static %}

{% block title %}News{% endblock %}
{% block meta_description %}Latest updates, achievements, and professional milestones in AI/ML development. Stay updated with the newest developments and announcements.{% endblock %}

{% block content %}
<!-- News Header -->
<section class="section-sm" style="padding-top: 120px;">
    <div class="container">
        <div class="text-center mb-xl">
            <h1 class="animate-fadeInDown">Latest <span class="text-purple">Updates</span></h1>
            <p class="text-lg opacity-90">
                Recent achievements, milestones, and professional developments in AI/ML innovation
            </p>
        </div>
        
        <!-- Search Bar -->
        <div class="search-section mb-lg">
            <div class="search-container" style="max-width: 500px; margin: 0 auto;">
                <form method="GET" class="search-form">
                    <div class="search-input-group" style="position: relative;">
                        <input type="text" 
                               name="q" 
                               value="{{ search_query|default:'' }}"
                               placeholder="Search news and updates..." 
                               class="form-input" 
                               style="padding-right: 50px;">
                        <button type="submit" 
                                class="search-button" 
                                style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: none; border: none; color: var(--accent-purple); cursor: pointer;">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                </form>
                {% if search_query %}
                <div class="search-results-info text-center mt-md">
                    <span class="text-sm opacity-75">
                        <i class="fas fa-search text-purple"></i>
                        Showing results for "<span class="text-purple">{{ search_query }}</span>"
                        <a href="{% url 'portfolio:news' %}" class="text-purple ml-2">
                            <i class="fas fa-times"></i> Clear
                        </a>
                    </span>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</section>

<!-- News Timeline -->
<section class="section-sm">
    <div class="container">
        {% if news_list %}
        <div class="news-timeline">
            {% for news in news_list %}
            <article class="news-item card animate-fadeInUp" 
                     data-searchable="{{ news.title|lower }} {{ news.summary|lower }} {{ news.content|lower }}">
                
                <!-- News Header -->
                <div class="news-header">
                    <div class="news-meta">
                        <span class="news-date">
                            <i class="fas fa-calendar text-purple"></i>
                            {{ news.published_at|date:"F d, Y" }}
                        </span>
                        {% if news.category %}
                        <span class="news-category">{{ news.category.name }}</span>
                        {% endif %}
                        {% if news.important %}
                        <span class="news-featured">
                            <i class="fas fa-star"></i>
                            Featured
                        </span>
                        {% endif %}
                        {% if news.status == 'published' %}
                        <span class="news-status published">
                            <i class="fas fa-check-circle"></i>
                            Published
                        </span>
                        {% else %}
                        <span class="news-status draft">
                            <i class="fas fa-clock"></i>
                            {{ news.status|title }}
                        </span>
                        {% endif %}
                    </div>
                    
                    <h3 class="news-title">
                        <a href="{{ news.get_absolute_url }}" class="text-white">{{ news.title }}</a>
                    </h3>
                </div>
                
                <!-- News Content -->
                <div class="news-content">
                    {% if news.summary %}
                    <p class="news-summary">{{ news.summary }}</p>
                    {% endif %}
                    
                    {% if news.content %}
                    <div class="news-excerpt">
                        {{ news.content|truncatewords:30|linebreaks }}
                    </div>
                    {% endif %}
                </div>
                
                <!-- News Footer -->
                <div class="news-footer">
                    <div class="news-actions">
                        <a href="{{ news.get_absolute_url }}" class="btn btn-primary btn-sm">
                            <i class="fas fa-arrow-right"></i>
                            Read More
                        </a>
                        {% if news.link %}
                        <a href="{{ news.link }}" target="_blank" class="btn btn-ghost btn-sm">
                            <i class="fas fa-external-link-alt"></i>
                            External Link
                        </a>
                        {% endif %}
                    </div>
                    
                    <div class="news-share">
                        <button class="btn btn-ghost btn-sm" onclick="shareNews('{{ news.title|escapejs }}', '{{ news.get_absolute_url }}')">
                            <i class="fas fa-share-alt"></i>
                            Share
                        </button>
                    </div>
                </div>
            </article>
            {% endfor %}
        </div>
        
        <!-- Load More Button -->
        {% if news_list|length >= 10 %}
        <div class="text-center mt-xl">
            <button class="btn btn-secondary btn-lg" id="load-more-btn">
                <i class="fas fa-chevron-down"></i>
                Load More Updates
            </button>
        </div>
        {% endif %}
        
        {% else %}
        <!-- No Results State -->
        <div class="text-center">
            <div class="card" style="max-width: 500px; margin: 0 auto;">
                {% if search_query %}
                <i class="fas fa-search fa-3x text-purple mb-md"></i>
                <h3>No Results Found</h3>
                <p>No news items match your search for "{{ search_query }}". Try different keywords or browse all updates.</p>
                <a href="{% url 'portfolio:news' %}" class="btn btn-primary">
                    <i class="fas fa-list"></i>
                    View All News
                </a>
                {% else %}
                <i class="fas fa-newspaper fa-3x text-purple mb-md"></i>
                <h3>News Updates Coming Soon</h3>
                <p>Stay tuned for the latest updates, achievements, and milestones in AI/ML development and professional journey.</p>
                <a href="{% url 'portfolio:contact' %}" class="btn btn-primary">
                    <i class="fas fa-bell"></i>
                    Get Notified
                </a>
                {% endif %}
            </div>
        </div>
        {% endif %}
    </div>
</section>

<!-- Featured Achievements -->
<section class="section bg-secondary">
    <div class="container">
        <div class="text-center mb-xl">
            <h2 class="animate-fadeInDown">Notable <span class="text-purple">Achievements</span></h2>
            <p class="text-lg opacity-90">
                Key milestones and recognition in AI/ML innovation
            </p>
        </div>
        
        <div class="grid grid-3">
            <div class="card text-center animate-fadeInUp">
                <div class="achievement-icon mb-md">
                    <i class="fas fa-trophy fa-3x text-purple"></i>
                </div>
                <h4>Industry Recognition</h4>
                <p>Awards and recognition for innovative AI/ML solutions and technical excellence in various industry competitions.</p>
                <div class="achievement-stats">
                    <div class="stat">
                        <span class="stat-number text-purple">15+</span>
                        <span class="stat-label">Awards</span>
                    </div>
                </div>
            </div>
            
            <div class="card text-center animate-fadeInUp">
                <div class="achievement-icon mb-md">
                    <i class="fas fa-code fa-3x text-purple"></i>
                </div>
                <h4>Open Source Contributions</h4>
                <p>Active contributions to the AI/ML community through open-source projects and collaborative development.</p>
                <div class="achievement-stats">
                    <div class="stat">
                        <span class="stat-number text-purple">50+</span>
                        <span class="stat-label">Projects</span>
                    </div>
                </div>
            </div>
            
            <div class="card text-center animate-fadeInUp">
                <div class="achievement-icon mb-md">
                    <i class="fas fa-users fa-3x text-purple"></i>
                </div>
                <h4>Community Impact</h4>
                <p>Mentoring, speaking engagements, and knowledge sharing initiatives within the AI/ML community.</p>
                <div class="achievement-stats">
                    <div class="stat">
                        <span class="stat-number text-purple">100+</span>
                        <span class="stat-label">Mentees</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Newsletter Subscription -->
<section class="section">
    <div class="container">
        <div class="text-center">
            <div class="card" style="max-width: 600px; margin: 0 auto;">
                <div class="animate-fadeInUp">
                    <h2 class="mb-md">Stay Updated with <span class="text-purple">Latest News</span></h2>
                    <p class="mb-lg opacity-90">
                        Subscribe to receive notifications about new achievements, project updates, and professional milestones.
                    </p>
                    
                    <form class="newsletter-form" style="display: flex; gap: var(--space-sm); max-width: 400px; margin: 0 auto;">
                        <input type="email" class="form-input" placeholder="Enter your email" required style="flex: 1;">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-bell"></i>
                            Subscribe
                        </button>
                    </form>
                    
                    <p class="mt-md text-sm opacity-75">
                        <i class="fas fa-shield-alt text-purple"></i>
                        Your privacy matters. Unsubscribe anytime.
                    </p>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_css %}
<style>
    .search-input-group {
        position: relative;
    }
    
    .search-button {
        transition: color var(--transition-base);
    }
    
    .search-button:hover {
        color: var(--white);
    }
    
    .news-timeline {
        display: flex;
        flex-direction: column;
        gap: var(--space-lg);
        max-width: 800px;
        margin: 0 auto;
    }
    
    .news-item {
        padding: var(--space-xl);
        transition: all var(--transition-base);
        border-left: 4px solid transparent;
    }
    
    .news-item:hover {
        border-left-color: var(--accent-purple);
        transform: translateX(8px);
    }
    
    .news-header {
        margin-bottom: var(--space-lg);
    }
    
    .news-meta {
        display: flex;
        flex-wrap: wrap;
        gap: var(--space-md);
        margin-bottom: var(--space-md);
        font-size: var(--font-size-sm);
    }
    
    .news-meta > span {
        display: flex;
        align-items: center;
        gap: var(--space-xs);
        padding: var(--space-xs) var(--space-sm);
        border-radius: var(--radius-full);
    }
    
    .news-date {
        color: var(--light-text);
        opacity: 0.8;
    }
    
    .news-category {
        background: var(--purple-20);
        color: var(--accent-purple);
    }
    
    .news-featured {
        background: var(--accent-purple);
        color: var(--white);
    }
    
    .news-status.published {
        background: rgba(34, 197, 94, 0.2);
        color: #22c55e;
    }
    
    .news-status.draft {
        background: rgba(251, 191, 36, 0.2);
        color: #fbbf24;
    }
    
    .news-title a {
        font-size: var(--font-size-2xl);
        font-weight: 600;
        line-height: 1.3;
        text-decoration: none;
        transition: color var(--transition-base);
    }
    
    .news-title a:hover {
        color: var(--accent-purple);
    }
    
    .news-summary {
        font-size: var(--font-size-lg);
        color: var(--light-text);
        font-weight: 500;
        margin-bottom: var(--space-md);
        opacity: 0.9;
    }
    
    .news-excerpt {
        color: var(--light-text);
        opacity: 0.8;
        line-height: 1.6;
        margin-bottom: var(--space-lg);
    }
    
    .news-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding-top: var(--space-md);
        border-top: 1px solid var(--purple-10);
    }
    
    .news-actions {
        display: flex;
        gap: var(--space-sm);
    }
    
    .achievement-icon {
        transition: transform var(--transition-base);
    }
    
    .card:hover .achievement-icon {
        transform: scale(1.1);
    }
    
    .achievement-stats {
        margin-top: var(--space-md);
    }
    
    .stat {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: var(--space-xs);
    }
    
    .stat-number {
        font-size: var(--font-size-2xl);
        font-weight: 700;
    }
    
    .stat-label {
        font-size: var(--font-size-sm);
        color: var(--light-text);
        opacity: 0.8;
    }
    
    .newsletter-form input {
        margin-bottom: 0;
    }
    
    @media (max-width: 768px) {
        .news-meta {
            flex-direction: column;
            align-items: flex-start;
            gap: var(--space-sm);
        }
        
        .news-footer {
            flex-direction: column;
            gap: var(--space-md);
            text-align: center;
        }
        
        .news-actions {
            flex-direction: column;
            width: 100%;
        }
        
        .news-actions .btn {
            width: 100%;
        }
        
        .newsletter-form {
            flex-direction: column;
        }
        
        .newsletter-form .btn {
            width: 100%;
        }
        
        .grid-3 {
            grid-template-columns: 1fr;
        }
    }
</style>
{% endblock %}

{% block extra_js %}
<script>
function shareNews(title, url) {
    const fullUrl = window.location.origin + url;
    
    if (navigator.share) {
        // Use native Web Share API if available
        navigator.share({
            title: title,
            url: fullUrl
        }).catch(console.error);
    } else {
        // Fallback to copying URL
        if (navigator.clipboard && window.isSecureContext) {
            navigator.clipboard.writeText(fullUrl).then(() => {
                showShareSuccess();
            });
        } else {
            // Fallback for older browsers
            const textArea = document.createElement('textarea');
            textArea.value = fullUrl;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);
            showShareSuccess();
        }
    }
}

function showShareSuccess() {
    // Create temporary success message
    const message = document.createElement('div');
    message.innerHTML = '<i class="fas fa-check"></i> Link copied to clipboard!';
    message.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: var(--accent-purple);
        color: white;
        padding: 12px 20px;
        border-radius: 6px;
        z-index: 9999;
        animation: slideInRight 0.3s ease-out;
    `;
    
    document.body.appendChild(message);
    
    setTimeout(() => {
        message.remove();
    }, 3000);
}

// Load more functionality
document.addEventListener('DOMContentLoaded', function() {
    const loadMoreBtn = document.getElementById('load-more-btn');
    if (loadMoreBtn) {
        loadMoreBtn.addEventListener('click', function() {
            // In a real implementation, this would make an AJAX request to load more news
            this.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Loading...';
            
            setTimeout(() => {
                this.innerHTML = '<i class="fas fa-check"></i> All updates loaded';
                this.disabled = true;
            }, 1500);
        });
    }
    
    // Newsletter form handling
    const newsletterForm = document.querySelector('.newsletter-form');
    if (newsletterForm) {
        newsletterForm.addEventListener('submit', function(e) {
            e.preventDefault();
            const email = this.querySelector('input[type="email"]').value;
            
            // Here you would typically send the email to your backend
            console.log('Newsletter signup:', email);
            
            // Show success message
            const button = this.querySelector('button');
            const originalText = button.innerHTML;
            button.innerHTML = '<i class="fas fa-check"></i> Subscribed!';
            button.disabled = true;
            
            setTimeout(() => {
                button.innerHTML = originalText;
                button.disabled = false;
                this.reset();
            }, 3000);
        });
    }
    
    // Search form auto-submit on input (debounced)
    const searchInput = document.querySelector('input[name="q"]');
    if (searchInput) {
        let searchTimeout;
        searchInput.addEventListener('input', function() {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
                if (this.value.length > 2 || this.value.length === 0) {
                    this.form.submit();
                }
            }, 500);
        });
    }
});

// Add slide in animation
const style = document.createElement('style');
style.textContent = `
    @keyframes slideInRight {
        from {
            transform: translateX(100%);
            opacity: 0;
        }
        to {
            transform: translateX(0);
            opacity: 1;
        }
    }
`;
document.head.appendChild(style);
</script>
{% endblock %}
